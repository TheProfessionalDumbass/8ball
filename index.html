<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic 8-Ball</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            box-sizing: border-box;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        .magic-ball {
            width: 150px;
            height: 150px;
            background-color: #000;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .answer-window {
            width: 70px;
            height: 70px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: #000;
            position: relative;
            z-index: 1;
        }
        #answer {
            margin-top: 20px;
            font-size: 1.5em;
            color: #333;
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        input, button {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        input {
            width: 80%;
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        .status {
            margin-top: 20px;
            font-size: 0.8em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Magic 8-Ball</h1>
        <p>Ask a question and click the button to get your answer!</p>
        <input type="text" id="question" placeholder="Type your question here">
        <button onclick="getAnswer()">Ask the 8-Ball</button>
        
        <div class="magic-ball" id="ball">
            <div class="answer-window" id="window">8</div>
        </div>
        
        <div id="answer"></div>
        <div class="status" id="status">Ready to answer your question</div>
    </div>

    <script>
        // Magic 8-Ball responses for fallback
        const localAnswers = [
            "It is certain", "It is decidedly so", "Without a doubt", 
            "Yes definitely", "You may rely on it", "As I see it, yes", 
            "Most likely", "Outlook good", "Yes", "Signs point to yes", 
            "Reply hazy, try again", "Ask again later", 
            "Better not tell you now", "Cannot predict now", 
            "Concentrate and ask again", "Don't count on it", 
            "My reply is no", "My sources say no", 
            "Outlook not so good", "Very doubtful"
        ];
        
        async function getAnswer() {
            const question = document.getElementById('question').value.trim();
            const answerDiv = document.getElementById('answer');
            const ball = document.getElementById('ball');
            const answerWindow = document.getElementById('window');
            const statusDiv = document.getElementById('status');
            
            if (!question) {
                answerDiv.textContent = "Please ask a question!";
                return;
            }
            
            // Add shake animation
            ball.classList.add('shake');
            
            // Reset animation after some time
            setTimeout(() => {
                ball.classList.remove('shake');
            }, 500);
            
            // Clear previous answer during "shake"
            answerWindow.textContent = "?";
            answerDiv.textContent = "Consulting the mystical forces...";
            statusDiv.textContent = "Connecting to the magic realm...";
            
            try {
                // Use the api.cors.lol proxy as specified
                const apiUrl = `https://api.cors.lol/?url=https://www.eightballapi.com/api/biased?question=${encodeURIComponent(question)}`;
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data && data.reading) {
                    const answer = data.reading;
                    
                    // Show short answer in the ball
                    const firstWord = answer.split(' ')[0];
                    answerWindow.textContent = firstWord;
                    
                    // Show full answer below
                    answerDiv.textContent = answer;
                    statusDiv.textContent = "The spirits have spoken";
                } else {
                    throw new Error("Invalid response from API");
                }
                
            } catch (error) {
                console.error("Error fetching from API:", error);
                
                // Fall back to local answers
                const randomIndex = Math.floor(Math.random() * localAnswers.length);
                const fallbackAnswer = localAnswers[randomIndex];
                
                answerWindow.textContent = fallbackAnswer.split(' ')[0];
                answerDiv.textContent = fallbackAnswer;
                statusDiv.textContent = "Using local magic (API connection failed)";
            }
        }
    </script>
</body>
</html>
